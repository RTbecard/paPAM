% Clear the decks
clear 

% Read in calibration tones from folder and calculate calibration ratios
% for all three channels, based on the input voltage peak-peak entered in
% the file name using filename format 'calibtone_ch_a_b_c.wav', where
% ch=channel (1,2,3), a=input voltage peak-peak (3 dp), b=recording level
% of device, c=date.
Caltonenames=dir('calibtone*.wav');
for i=1:3
    caldat=wavread(Caltonenames(i).name);
    mincaldat(i)=min(caldat);
    maxcaldat(i)=max(caldat);
    inputvpp(i)=str2num(Caltonenames(i).name(13:17)); 
    cals(i)=inputvpp(i)/(maxcaldat(i)-mincaldat(i));
end

% Accelerometer sensitivity data for frequencies 0-3000 Hz
sens=[NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;4.56999982997866e-05;5.02699981297653e-05;5.48399979597440e-05;5.94099977897226e-05;6.39799976197013e-05;6.85499974496800e-05;7.31199972796586e-05;7.76899971096373e-05;8.22599969396159e-05;8.68299967695946e-05;9.13999965995733e-05;9.59699964295519e-05;0.000100539996259531;0.000105109996089509;0.000109679995919488;0.000114249995749467;0.000118819995579445;0.000123389995409424;0.000127959995239403;0.000132529995069381;0.000137099994899360;0.000141669994729339;0.000146239994559317;0.000150809994389296;0.000155379994219275;0.000159949994049253;0.000164519993879232;0.000169089993709211;0.000173659993539189;0.000178229993369168;0.000182799993199146;0.000187369993029125;0.000191939992859104;0.000196509992689082;0.000201079992519061;0.000205649992349040;0.000210219992179018;0.000214789992008997;0.000219359991838976;0.000223929991668954;0.000228499991498933;0.000233069991328912;0.000237639991158890;0.000242209990988869;0.000246779990818848;0.000251349990648826;0.000255919990478805;0.000260489990308784;0.000265059990138762;0.000269629989968741;0.000274199989798720;0.000278769989628698;0.000283339989458677;0.000287909989288656;0.000292479989118634;0.000297049988948613;0.000301619988778592;0.000306189988608570;0.000310759988438549;0.000315329988268528;0.000319899988098506;0.000324469987928485;0.000329039987758464;0.000333609987588442;0.000338179987418421;0.000342749987248400;0.000347319987078378;0.000351889986908357;0.000356459986738336;0.000361029986568314;0.000365599986398293;0.000370169986228272;0.000374739986058250;0.000379309985888229;0.000383879985718208;0.000388449985548186;0.000393019985378165;0.000397589985208144;0.000402159985038122;0.000406729984868101;0.000411299984698080;0.000415869984528058;0.000420439984358037;0.000425009984188016;0.000429579984017994;0.000434149983847973;0.000438719983677952;0.000443289983507930;0.000447859983337909;0.000452429983167888;0.000456999982997866;0.000461569982827845;0.000466139982657823;0.000470709982487802;0.000475279982317781;0.000479849982147759;0.000484419981977738;0.000488989981807717;0.000493559981637696;0.000498129981467674;0.000502699981297653;0.000507269981127632;0.000511839980957610;0.000516409980787589;0.000520979980617568;0.000525549980447546;0.000530119980277525;0.000534689980107504;0.000539259979937482;0.000543829979767461;0.000548399979597439;0.000552969979427418;0.000557539979257397;0.000562109979087375;0.000566679978917354;0.000571249978747333;0.000575819978577311;0.000580389978407290;0.000584959978237269;0.000589529978067247;0.000594099977897226;0.000598669977727205;0.000603239977557183;0.000607809977387162;0.000612379977217141;0.000616949977047119;0.000621519976877098;0.000626089976707077;0.000630659976537055;0.000635229976367034;0.000639799976197013;0.000644369976026991;0.000648939975856970;0.000653509975686949;0.000658079975516927;0.000662649975346906;0.000667219975176885;0.000671789975006863;0.000676359974836842;0.000680929974666821;0.000685499974496799;0.000690069974326778;0.000694639974156757;0.000699209973986735;0.000703779973816714;0.000708349973646693;0.000712919973476671;0.000717489973306650;0.000722059973136629;0.000726629972966607;0.000731199972796586;0.000735769972626565;0.000740339972456543;0.000744909972286522;0.000749479972116501;0.000754049971946479;0.000758619971776458;0.000763189971606437;0.000767759971436415;0.000772329971266394;0.000776899971096373;0.000781469970926351;0.000786039970756330;0.000790609970586308;0.000795179970416287;0.000799749970246266;0.000804319970076244;0.000808889969906223;0.000813459969736202;0.000818029969566180;0.000822599969396159;0.000827169969226138;0.000831739969056117;0.000836309968886095;0.000840879968716074;0.000845449968546052;0.000850019968376031;0.000854589968206010;0.000859159968035988;0.000863729967865967;0.000868299967695946;0.000872869967525924;0.000877439967355903;0.000882009967185882;0.000886579967015860;0.000891149966845839;0.000895719966675818;0.000900289966505796;0.000904859966335775;0.000909429966165754;0.000913999965995732;0.000918569965825711;0.000923139965655690;0.000927709965485668;0.000932279965315647;0.000936849965145626;0.000941419964975604;0.000945989964805583;0.000950559964635562;0.000955129964465540;0.000959699964295519;0.000964269964125498;0.000968839963955476;0.000973409963785455;0.000977979963615434;0.000982549963445413;0.000987119963275391;0.000991689963105370;0.000996259962935348;0.00100082996276533;0.00100539996259531;0.00100996996242528;0.00101453996225526;0.00101910996208524;0.00102367996191522;0.00102824996174520;0.00103281996157518;0.00103738996140516;0.00104195996123514;0.00104652996106511;0.00105109996089509;0.00105566996072507;0.00106023996055505;0.00106480996038503;0.00106937996021501;0.00107394996004499;0.00107851995987496;0.00108308995970494;0.00108765995953492;0.00109222995936490;0.00109679995919488;0.00110136995902486;0.00110593995885484;0.00111050995868481;0.00111507995851479;0.00111964995834477;0.00112421995817475;0.00112878995800473;0.00113335995783471;0.00113792995766469;0.00114249995749467;0.00114952005311065;0.00115654014872663;0.00116356024434261;0.00117058033995859;0.00117760043557457;0.00118462053119055;0.00119164062680653;0.00119866072242251;0.00120568081803849;0.00121270091365447;0.00121972100927045;0.00122674110488643;0.00123376120050241;0.00124078129611839;0.00124780139173437;0.00125482148735035;0.00126184158296633;0.00126886167858231;0.00127588177419829;0.00128290186981427;0.00128992196543025;0.00129694206104623;0.00130396215666221;0.00131098225227819;0.00131800234789417;0.00132443517226442;0.00133086799663468;0.00133730082100494;0.00134373364537519;0.00135016646974545;0.00135659929411570;0.00136303211848596;0.00136946494285622;0.00137589776722647;0.00138233059159673;0.00138876341596699;0.00139519624033724;0.00140162906470750;0.00140806188907775;0.00141449471344801;0.00142092753781827;0.00142736036218852;0.00143379318655878;0.00144022601092904;0.00144665883529929;0.00145309165966955;0.00145952448403980;0.00146595730841006;0.00147239013278032;0.00147882295715057;0.00148375236700774;0.00148868177686491;0.00149361118672208;0.00149854059657925;0.00150347000643642;0.00150839941629358;0.00151332882615075;0.00151825823600792;0.00152318764586509;0.00152811705572226;0.00153304646557943;0.00153797587543660;0.00154290528529376;0.00154783469515093;0.00155276410500810;0.00155769351486527;0.00156262292472244;0.00156755233457961;0.00157248174443678;0.00157741115429395;0.00159489824402781;0.00161238533376167;0.00162987242349554;0.00164735951322940;0.00166484660296326;0.00168233369269713;0.00169982078243099;0.00171730787216485;0.00173479496189872;0.00175228205163258;0.00176976914136644;0.00178725623110031;0.00180474332083417;0.00182223041056804;0.00183971750030190;0.00185720459003576;0.00187469167976963;0.00189217876950349;0.00190966585923735;0.00192715294897122;0.00193891036017306;0.00195066777137491;0.00196242518257676;0.00197418259377861;0.00198594000498045;0.00199769741618230;0.00200945482738415;0.00202121223858599;0.00203296964978784;0.00204472706098969;0.00205648447219153;0.00206824188339338;0.00207999929459523;0.00209175670579707;0.00210351411699892;0.00211527152820077;0.00212702893940261;0.00213878635060446;0.00215054376180631;0.00216230117300816;0.00218293435217231;0.00220356753133646;0.00222420071050062;0.00224483388966477;0.00226546706882893;0.00228610024799308;0.00230673342715724;0.00232736660632139;0.00234799978548555;0.00236863296464970;0.00238926614381386;0.00240989932297801;0.00243053250214217;0.00245116568130632;0.00247179886047048;0.00249243203963463;0.00251306521879879;0.00253369839796294;0.00255433157712709;0.00257496475629125;0.00258174097933412;0.00258851720237699;0.00259529342541986;0.00260206964846274;0.00260884587150561;0.00261562209454848;0.00262239831759135;0.00262917454063422;0.00263595076367709;0.00264272698671996;0.00264950320976284;0.00265627943280571;0.00266305565584858;0.00266983187889145;0.00267660810193432;0.00268338432497719;0.00269016054802007;0.00269693677106294;0.00270371299410581;0.00271048921714868;0.00272463916055932;0.00273878910396996;0.00275293904738060;0.00276708899079124;0.00278123893420188;0.00279538887761252;0.00280953882102316;0.00282368876443380;0.00283783870784443;0.00285198865125507;0.00286613859466571;0.00288028853807635;0.00289443848148699;0.00290858842489763;0.00292273836830827;0.00293688831171891;0.00295103825512955;0.00296518819854019;0.00297933814195083;0.00299348808536147;0.00301084310693723;0.00302819812851300;0.00304555315008876;0.00306290817166453;0.00308026319324029;0.00309761821481606;0.00311497323639182;0.00313232825796759;0.00314968327954335;0.00316703830111912;0.00318439332269488;0.00320174834427065;0.00321910336584641;0.00323645838742218;0.00325381340899795;0.00327116843057371;0.00328852345214948;0.00330587847372524;0.00332323349530101;0.00334058851687677;0.00334901897517292;0.00335744943346907;0.00336587989176523;0.00337431035006138;0.00338274080835753;0.00339117126665368;0.00339960172494983;0.00340803218324598;0.00341646264154214;0.00342489309983829;0.00343332355813444;0.00344175401643059;0.00345018447472674;0.00345861493302289;0.00346704539131905;0.00347547584961520;0.00348390630791135;0.00349233676620750;0.00350076722450365;0.00350919768279980;0.00352178585037703;0.00353437401795425;0.00354696218553147;0.00355955035310870;0.00357213852068592;0.00358472668826314;0.00359731485584037;0.00360990302341759;0.00362249119099481;0.00363507935857204;0.00364766752614926;0.00366025569372648;0.00367284386130371;0.00368543202888093;0.00369802019645816;0.00371060836403538;0.00372319653161260;0.00373578469918983;0.00374837286676705;0.00376096103434427;0.00376927154249933;0.00377758205065438;0.00378589255880944;0.00379420306696450;0.00380251357511955;0.00381082408327461;0.00381913459142966;0.00382744509958472;0.00383575560773978;0.00384406611589483;0.00385237662404989;0.00386068713220494;0.00386899764036000;0.00387730814851505;0.00388561865667011;0.00389392916482517;0.00390223967298022;0.00391055018113528;0.00391886068929034;0.00392717119744539;0.00393902748174470;0.00395088376604400;0.00396274005034331;0.00397459633464262;0.00398645261894192;0.00399830890324123;0.00401016518754054;0.00402202147183984;0.00403387775613915;0.00404573404043846;0.00405759032473776;0.00406944660903707;0.00408130289333638;0.00409315917763568;0.00410501546193499;0.00411687174623430;0.00412872803053360;0.00414058431483291;0.00415244059913222;0.00416429688343152;0.00417705629928185;0.00418981571513218;0.00420257513098250;0.00421533454683283;0.00422809396268316;0.00424085337853349;0.00425361279438381;0.00426637221023414;0.00427913162608447;0.00429189104193480;0.00430465045778512;0.00431740987363545;0.00433016928948578;0.00434292870533611;0.00435568812118643;0.00436844753703676;0.00438120695288709;0.00439396636873741;0.00440672578458774;0.00441948520043807;0.00443209746671040;0.00444470973298273;0.00445732199925506;0.00446993426552739;0.00448254653179972;0.00449515879807204;0.00450777106434437;0.00452038333061670;0.00453299559688903;0.00454560786316136;0.00455822012943369;0.00457083239570602;0.00458344466197835;0.00459605692825068;0.00460866919452301;0.00462128146079534;0.00463389372706767;0.00464650599334000;0.00465911825961232;0.00467173052588465;0.00470461505267620;0.00473749957946774;0.00477038410625929;0.00480326863305083;0.00483615315984238;0.00486903768663392;0.00490192221342547;0.00493480674021701;0.00496769126700856;0.00500057579380010;0.00503346032059164;0.00506634484738319;0.00509922937417473;0.00513211390096628;0.00516499842775782;0.00519788295454937;0.00523076748134091;0.00526365200813246;0.00529653653492400;0.00532942106171555;0.00533941830620165;0.00534941555068776;0.00535941279517387;0.00536941003965998;0.00537940728414608;0.00538940452863219;0.00539940177311830;0.00540939901760441;0.00541939626209052;0.00542939350657662;0.00543939075106273;0.00544938799554884;0.00545938524003495;0.00546938248452105;0.00547937972900716;0.00548937697349327;0.00549937421797938;0.00550937146246549;0.00551936870695159;0.00552936595143770;0.00554877995541752;0.00556819395939734;0.00558760796337716;0.00560702196735699;0.00562643597133681;0.00564584997531663;0.00566526397929645;0.00568467798327627;0.00570409198725609;0.00572350599123591;0.00574291999521573;0.00576233399919555;0.00578174800317537;0.00580116200715519;0.00582057601113501;0.00583999001511483;0.00585940401909465;0.00587881802307448;0.00589823202705430;0.00591764603103412;0.00593203637468726;0.00594642671834040;0.00596081706199354;0.00597520740564668;0.00598959774929982;0.00600398809295296;0.00601837843660610;0.00603276878025925;0.00604715912391239;0.00606154946756553;0.00607593981121867;0.00609033015487181;0.00610472049852495;0.00611911084217809;0.00613350118583123;0.00614789152948438;0.00616228187313752;0.00617667221679066;0.00619106256044380;0.00620545290409694;0.00621750243632610;0.00622955196855526;0.00624160150078443;0.00625365103301359;0.00626570056524275;0.00627775009747191;0.00628979962970107;0.00630184916193023;0.00631389869415939;0.00632594822638855;0.00633799775861771;0.00635004729084688;0.00636209682307604;0.00637414635530520;0.00638619588753436;0.00639824541976352;0.00641029495199268;0.00642234448422184;0.00643439401645101;0.00644644354868017;0.00645427417383571;0.00646210479899125;0.00646993542414679;0.00647776604930233;0.00648559667445787;0.00649342729961341;0.00650125792476895;0.00650908854992449;0.00651691917508003;0.00652474980023557;0.00653258042539111;0.00654041105054665;0.00654824167570219;0.00655607230085774;0.00656390292601328;0.00657173355116882;0.00657956417632436;0.00658739480147990;0.00659522542663544;0.00660305605179098;0.00661369371666474;0.00662433138153850;0.00663496904641226;0.00664560671128602;0.00665624437615978;0.00666688204103354;0.00667751970590730;0.00668815737078106;0.00669879503565482;0.00670943270052858;0.00672007036540234;0.00673070803027610;0.00674134569514986;0.00675198336002362;0.00676262102489738;0.00677325868977114;0.00678389635464490;0.00679453401951866;0.00680517168439242;0.00681580934926618;0.00682848076602579;0.00684115218278540;0.00685382359954501;0.00686649501630463;0.00687916643306424;0.00689183784982385;0.00690450926658346;0.00691718068334307;0.00692985210010269;0.00694252351686230;0.00695519493362191;0.00696786635038152;0.00698053776714114;0.00699320918390075;0.00700588060066036;0.00701855201741997;0.00703122343417958;0.00704389485093920;0.00705656626769881;0.00706923768445842;0.00708167906816857;0.00709412045187873;0.00710656183558888;0.00711900321929904;0.00713144460300919;0.00714388598671935;0.00715632737042950;0.00716876875413966;0.00718121013784981;0.00719365152155997;0.00720609290527012;0.00721853428898028;0.00723097567269043;0.00724341705640059;0.00725585844011074;0.00726829982382090;0.00728074120753105;0.00729318259124121;0.00730562397495136;0.00731806535866152;0.00733177977732793;0.00734549419599434;0.00735920861466075;0.00737292303332716;0.00738663745199358;0.00740035187065999;0.00741406628932640;0.00742778070799281;0.00744149512665922;0.00745520954532563;0.00746892396399204;0.00748263838265846;0.00749635280132487;0.00751006721999128;0.00752378163865769;0.00753749605732410;0.00755121047599051;0.00756492489465692;0.00757863931332334;0.00759235373198975;0.00760668231125620;0.00762101089052265;0.00763533946978911;0.00764966804905556;0.00766399662832202;0.00767832520758847;0.00769265378685492;0.00770698236612138;0.00772131094538783;0.00773563952465429;0.00774996810392074;0.00776429668318719;0.00777862526245365;0.00779295384172010;0.00780728242098656;0.00782161100025301;0.00783593957951946;0.00785026815878592;0.00786459673805237;0.00787892531731882;0.00788856676662053;0.00789820821592223;0.00790784966522394;0.00791749111452564;0.00792713256382735;0.00793677401312905;0.00794641546243075;0.00795605691173246;0.00796569836103416;0.00797533981033587;0.00798498125963757;0.00799462270893927;0.00800426415824098;0.00801390560754268;0.00802354705684439;0.00803318850614609;0.00804282995544780;0.00805247140474950;0.00806211285405120;0.00807175430335291;0.00808389684947462;0.00809603939559634;0.00810818194171805;0.00812032448783977;0.00813246703396148;0.00814460958008320;0.00815675212620491;0.00816889467232663;0.00818103721844834;0.00819317976457006;0.00820532231069177;0.00821746485681349;0.00822960740293520;0.00824174994905692;0.00825389249517863;0.00826603504130035;0.00827817758742206;0.00829032013354378;0.00830246267966549;0.00831460522578721;0.00832490560811704;0.00833520599044688;0.00834550637277672;0.00835580675510655;0.00836610713743639;0.00837640751976623;0.00838670790209606;0.00839700828442590;0.00840730866675573;0.00841760904908557;0.00842790943141541;0.00843820981374524;0.00844851019607508;0.00845881057840492;0.00846911096073475;0.00847941134306459;0.00848971172539443;0.00850001210772426;0.00851031249005410;0.00852061287238394;0.00851143749099897;0.00850226210961401;0.00849308672822904;0.00848391134684408;0.00847473596545911;0.00846556058407415;0.00845638520268919;0.00844720982130422;0.00843803443991926;0.00842885905853430;0.00841968367714933;0.00841050829576437;0.00840133291437940;0.00839215753299444;0.00838298215160948;0.00837380677022451;0.00836463138883955;0.00835545600745458;0.00834628062606962;0.00833710524468466;0.00834126039614875;0.00834541554761285;0.00834957069907695;0.00835372585054105;0.00835788100200515;0.00836203615346925;0.00836619130493335;0.00837034645639745;0.00837450160786155;0.00837865675932565;0.00838281191078975;0.00838696706225385;0.00839112221371794;0.00839527736518204;0.00839943251664614;0.00840358766811024;0.00840774281957434;0.00841189797103844;0.00841605312250254;0.00842020827396664;0.00842699146541087;0.00843377465685509;0.00844055784829932;0.00844734103974355;0.00845412423118778;0.00846090742263200;0.00846769061407623;0.00847447380552046;0.00848125699696469;0.00848804018840891;0.00849482337985314;0.00850160657129737;0.00850838976274160;0.00851517295418582;0.00852195614563005;0.00852873933707428;0.00853552252851851;0.00854230571996273;0.00854908891140696;0.00855587210285119;0.00856503462958233;0.00857419715631348;0.00858335968304463;0.00859252220977577;0.00860168473650692;0.00861084726323806;0.00862000978996921;0.00862917231670035;0.00863833484343150;0.00864749737016264;0.00865665989689379;0.00866582242362494;0.00867498495035608;0.00868414747708723;0.00869331000381837;0.00870247253054952;0.00871163505728066;0.00872079758401181;0.00872996011074296;0.00873912263747410;0.00874555062931864;0.00875197862116318;0.00875840661300771;0.00876483460485225;0.00877126259669679;0.00877769058854133;0.00878411858038587;0.00879054657223040;0.00879697456407494;0.00880340255591948;0.00880983054776402;0.00881625853960856;0.00882268653145309;0.00882911452329763;0.00883554251514217;0.00884197050698671;0.00884839849883125;0.00885482649067578;0.00886125448252032;0.00886768247436486;0.00886962351642556;0.00887156455848626;0.00887350560054697;0.00887544664260767;0.00887738768466837;0.00887932872672907;0.00888126976878978;0.00888321081085048;0.00888515185291118;0.00888709289497188;0.00888903393703259;0.00889097497909329;0.00889291602115399;0.00889485706321469;0.00889679810527540;0.00889873914733610;0.00890068018939680;0.00890262123145750;0.00890456227351820;0.00890650331557891;0.00890502295195908;0.00890354258833926;0.00890206222471944;0.00890058186109961;0.00889910149747979;0.00889762113385996;0.00889614077024014;0.00889466040662032;0.00889318004300049;0.00889169967938067;0.00889021931576084;0.00888873895214102;0.00888725858852120;0.00888577822490137;0.00888429786128155;0.00888281749766172;0.00888133713404190;0.00887985677042208;0.00887837640680225;0.00887689604318243;0.00887538062266056;0.00887386520213870;0.00887234978161683;0.00887083436109497;0.00886931894057310;0.00886780352005124;0.00886628809952937;0.00886477267900751;0.00886325725848564;0.00886174183796378;0.00886022641744191;0.00885871099692005;0.00885719557639818;0.00885568015587632;0.00885416473535445;0.00885264931483259;0.00885113389431072;0.00884961847378886;0.00884810305326699;0.00884658763274513;0.00884049333277066;0.00883439903279619;0.00882830473282172;0.00882221043284725;0.00881611613287278;0.00881002183289831;0.00880392753292384;0.00879783323294937;0.00879173893297490;0.00878564463300043;0.00877955033302596;0.00877345603305149;0.00876736173307702;0.00876126743310255;0.00875517313312808;0.00874907883315361;0.00874298453317914;0.00873689023320467;0.00873079593323020;0.00872470163325573;0.00871687002983771;0.00870903842641969;0.00870120682300167;0.00869337521958365;0.00868554361616563;0.00867771201274761;0.00866988040932960;0.00866204880591158;0.00865421720249356;0.00864638559907554;0.00863855399565752;0.00863072239223951;0.00862289078882149;0.00861505918540347;0.00860722758198545;0.00859939597856743;0.00859156437514941;0.00858373277173139;0.00857590116831338;0.00856806956489536;0.00856018219659781;0.00855229482830026;0.00854440746000271;0.00853652009170516;0.00852863272340761;0.00852074535511006;0.00851285798681252;0.00850497061851497;0.00849708325021742;0.00848919588191987;0.00848130851362232;0.00847342114532477;0.00846553377702723;0.00845764640872968;0.00844975904043213;0.00844187167213458;0.00843398430383703;0.00842609693553948;0.00841820956724193;0.00841032219894438;0.00840206033585732;0.00839379847277025;0.00838553660968318;0.00837727474659612;0.00836901288350905;0.00836075102042198;0.00835248915733492;0.00834422729424785;0.00833596543116078;0.00832770356807372;0.00831944170498665;0.00831117984189958;0.00830291797881252;0.00829465611572545;0.00828639425263839;0.00827813238955132;0.00826987052646425;0.00826160866337719;0.00825334680029012;0.00824508493720305;0.00823523844220641;0.00822539194720976;0.00821554545221312;0.00820569895721648;0.00819585246221983;0.00818600596722319;0.00817615947222654;0.00816631297722990;0.00815646648223326;0.00814661998723661;0.00813677349223997;0.00812692699724332;0.00811708050224668;0.00810723400725004;0.00809738751225339;0.00808754101725675;0.00807769452226011;0.00806784802726346;0.00805800153226682;0.00804815503727017;0.00803956716788943;0.00803097929850870;0.00802239142912796;0.00801380355974722;0.00800521569036648;0.00799662782098574;0.00798803995160500;0.00797945208222427;0.00797086421284353;0.00796227634346279;0.00795368847408205;0.00794510060470131;0.00793651273532057;0.00792792486593983;0.00791933699655910;0.00791074912717836;0.00790216125779762;0.00789357338841688;0.00788498551903614;0.00787639764965540;0.00786561451225071;0.00785483137484602;0.00784404823744133;0.00783326510003664;0.00782248196263194;0.00781169882522725;0.00780091568782256;0.00779013255041787;0.00777934941301318;0.00776856627560849;0.00775778313820379;0.00774700000079910;0.00773621686339441;0.00772543372598972;0.00771465058858503;0.00770386745118034;0.00769308431377564;0.00768230117637095;0.00767151803896626;0.00766073490156157;0.00763986212318850;0.00761898934481543;0.00759811656644236;0.00757724378806928;0.00755637100969621;0.00753549823132314;0.00751462545295007;0.00749375267457700;0.00747287989620393;0.00745200711783086;0.00743113433945779;0.00741026156108471;0.00738938878271164;0.00736851600433857;0.00734764322596550;0.00732677044759243;0.00730589766921936;0.00728502489084629;0.00726415211247322;0.00724327933410014;0.00723836898749310;0.00723345864088606;0.00722854829427902;0.00722363794767198;0.00721872760106494;0.00721381725445790;0.00720890690785086;0.00720399656124382;0.00719908621463678;0.00719417586802974;0.00718926552142270;0.00718435517481565;0.00717944482820861;0.00717453448160157;0.00716962413499453;0.00716471378838749;0.00715980344178045;0.00715489309517341;0.00714998274856637;0.00714507240195933;0.00713160367466894;0.00711813494737854;0.00710466622008815;0.00709119749279776;0.00707772876550736;0.00706426003821697;0.00705079131092658;0.00703732258363618;0.00702385385634579;0.00701038512905540;0.00699691640176500;0.00698344767447461;0.00696997894718422;0.00695651021989382;0.00694304149260343;0.00692957276531304;0.00691610403802265;0.00690263531073225;0.00688916658344186;0.00687569785615147;0.00688972194524637;0.00690374603434127;0.00691777012343618;0.00693179421253108;0.00694581830162598;0.00695984239072089;0.00697386647981579;0.00698789056891070;0.00700191465800560;0.00701593874710050;0.00702996283619541;0.00704398692529031;0.00705801101438521;0.00707203510348012;0.00708605919257502;0.00710008328166992;0.00711410737076483;0.00712813145985973;0.00714215554895463;0.00715617963804954;0.00712986829410795;0.00710355695016637;0.00707724560622478;0.00705093426228319;0.00702462291834161;0.00699831157440002;0.00697200023045844;0.00694568888651685;0.00691937754257526;0.00689306619863368;0.00686675485469209;0.00684044351075051;0.00681413216680892;0.00678782082286734;0.00676150947892575;0.00673519813498416;0.00670888679104258;0.00668257544710099;0.00665626410315941;0.00662995275921782;0.00662787794704605;0.00662580313487428;0.00662372832270252;0.00662165351053075;0.00661957869835898;0.00661750388618721;0.00661542907401544;0.00661335426184367;0.00661127944967191;0.00660920463750014;0.00660712982532837;0.00660505501315660;0.00660298020098483;0.00660090538881307;0.00659883057664130;0.00659675576446953;0.00659468095229776;0.00659260614012599;0.00659053132795423;0.00658845651578246;0.00658158795461183;0.00657471939344119;0.00656785083227056;0.00656098227109993;0.00655411370992929;0.00654724514875866;0.00654037658758803;0.00653350802641740;0.00652663946524676;0.00651977090407613;0.00651290234290550;0.00650603378173487;0.00649916522056423;0.00649229665939360;0.00648542809822297;0.00647855953705233;0.00647169097588170;0.00646482241471107;0.00645795385354044;0.00645108529236980;0.00644009704895050;0.00642910880553119;0.00641812056211188;0.00640713231869257;0.00639614407527327;0.00638515583185396;0.00637416758843465;0.00636317934501534;0.00635219110159604;0.00634120285817673;0.00633021461475742;0.00631922637133811;0.00630823812791881;0.00629724988449950;0.00628626164108019;0.00627527339766088;0.00626428515424158;0.00625329691082227;0.00624230866740296;0.00623132042398365;0.00623034842166418;0.00622937641934470;0.00622840441702523;0.00622743241470575;0.00622646041238628;0.00622548841006680;0.00622451640774732;0.00622354440542785;0.00622257240310837;0.00622160040078890;0.00622062839846942;0.00621965639614995;0.00621868439383047;0.00621771239151100;0.00621674038919152;0.00621576838687205;0.00621479638455257;0.00621382438223309;0.00621285237991362;0.00621188037759414;0.00620049390198058;0.00618910742636702;0.00617772095075346;0.00616633447513991;0.00615494799952635;0.00614356152391279;0.00613217504829923;0.00612078857268567;0.00610940209707211;0.00609801562145855;0.00608662914584499;0.00607524267023143;0.00606385619461787;0.00605246971900431;0.00604108324339075;0.00602969676777719;0.00601831029216363;0.00600692381655007;0.00599553734093651;0.00598415086532295;0.00598342047139948;0.00598269007747600;0.00598195968355252;0.00598122928962904;0.00598049889570557;0.00597976850178209;0.00597903810785861;0.00597830771393514;0.00597757732001166;0.00597684692608818;0.00597611653216471;0.00597538613824123;0.00597465574431775;0.00597392535039427;0.00597319495647080;0.00597246456254732;0.00597173416862384;0.00597100377470037;0.00597027338077689;0.00596954298685341;0.00595488210759355;0.00594022122833368;0.00592556034907382;0.00591089946981396;0.00589623859055409;0.00588157771129423;0.00586691683203437;0.00585225595277450;0.00583759507351464;0.00582293419425478;0.00580827331499491;0.00579361243573505;0.00577895155647518;0.00576429067721532;0.00574962979795546;0.00573496891869559;0.00572030803943573;0.00570564716017587;0.00569098628091600;0.00567632540165614;0.00567697403263338;0.00567762266361062;0.00567827129458785;0.00567891992556509;0.00567956855654233;0.00568021718751957;0.00568086581849681;0.00568151444947405;0.00568216308045129;0.00568281171142852;0.00568346034240576;0.00568410897338300;0.00568475760436024;0.00568540623533748;0.00568605486631472;0.00568670349729195;0.00568735212826919;0.00568800075924643;0.00568864939022367;0.00568929802120091;0.00568102025087449;0.00567274248054808;0.00566446471022166;0.00565618693989524;0.00564790916956883;0.00563963139924241;0.00563135362891599;0.00562307585858958;0.00561479808826316;0.00560652031793675;0.00559824254761033;0.00558996477728391;0.00558168700695750;0.00557340923663108;0.00556513146630467;0.00555685369597825;0.00554857592565183;0.00554029815532542;0.00553202038499900;0.00552374261467258;0.00551658327036477;0.00550942392605696;0.00550226458174915;0.00549510523744134;0.00548794589313352;0.00548078654882571;0.00547362720451790;0.00546646786021009;0.00545930851590227;0.00545214917159446;0.00544498982728665;0.00543783048297884;0.00543067113867102;0.00542351179436321;0.00541635245005540;0.00540919310574759;0.00540203376143978;0.00539487441713196;0.00538771507282415;0.00538055572851634;0.00536726430730443;0.00535397288609252;0.00534068146488062;0.00532739004366871;0.00531409862245680;0.00530080720124489;0.00528751578003299;0.00527422435882108;0.00526093293760917;0.00524764151639727;0.00523435009518536;0.00522105867397345;0.00520776725276154;0.00519447583154964;0.00518118441033773;0.00516789298912582;0.00515460156791392;0.00514131014670201;0.00512801872549010;0.00511472730427819;0.00511795723097313;0.00512118715766808;0.00512441708436302;0.00512764701105796;0.00513087693775290;0.00513410686444784;0.00513733679114278;0.00514056671783772;0.00514379664453266;0.00514702657122760;0.00515025649792254;0.00515348642461748;0.00515671635131242;0.00515994627800737;0.00516317620470231;0.00516640613139725;0.00516963605809219;0.00517286598478713;0.00517609591148207;0.00517932583817701;0.00516985471382924;0.00516038358948148;0.00515091246513371;0.00514144134078594;0.00513197021643818;0.00512249909209041;0.00511302796774264;0.00510355684339488;0.00509408571904711;0.00508461459469934;0.00507514347035157;0.00506567234600381;0.00505620122165604;0.00504673009730827;0.00503725897296051;0.00502778784861274;0.00501831672426497;0.00500884559991721;0.00499937447556944;0.00498990335122167;0.00498795918549245;0.00498601501976322;0.00498407085403400;0.00498212668830477;0.00498018252257555;0.00497823835684632;0.00497629419111710;0.00497435002538787;0.00497240585965865;0.00497046169392942;0.00496851752820020;0.00496657336247097;0.00496462919674175;0.00496268503101252;0.00496074086528330;0.00495879669955407;0.00495685253382484;0.00495490836809562;0.00495296420236639;0.00495102003663717;0.00494851747263185;0.00494601490862654;0.00494351234462122;0.00494100978061591;0.00493850721661059;0.00493600465260528;0.00493350208859996;0.00493099952459465;0.00492849696058933;0.00492599439658401;0.00492349183257870;0.00492098926857338;0.00491848670456807;0.00491598414056275;0.00491348157655744;0.00491097901255212;0.00490847644854681;0.00490597388454149;0.00490347132053617;0.00490096875653086;0.00488279233889122;0.00486461592125158;0.00484643950361194;0.00482826308597229;0.00481008666833265;0.00479191025069301;0.00477373383305337;0.00475555741541373;0.00473738099777409;0.00471920458013445;0.00470102816249481;0.00468285174485516;0.00466467532721552;0.00464649890957588;0.00462832249193624;0.00461014607429660;0.00459196965665696;0.00457379323901732;0.00455561682137768;0.00453744040373803;0.00454285248631892;0.00454826456889980;0.00455367665148069;0.00455908873406157;0.00456450081664246;0.00456991289922334;0.00457532498180422;0.00458073706438511;0.00458614914696599;0.00459156122954688;0.00459697331212776;0.00460238539470864;0.00460779747728953;0.00461320955987041;0.00461862164245130;0.00462403372503218;0.00462944580761307;0.00463485789019395;0.00464026997277483;0.00464568205535572;0.00464010044154237;0.00463451882772903;0.00462893721391568;0.00462335560010234;0.00461777398628899;0.00461219237247565;0.00460661075866231;0.00460102914484896;0.00459544753103562;0.00458986591722227;0.00458428430340893;0.00457870268959558;0.00457312107578224;0.00456753946196889;0.00456195784815555;0.00455637623434220;0.00455079462052886;0.00454521300671552;0.00453963139290217;0.00453404977908883;0.00453162413523176;0.00452919849137469;0.00452677284751761;0.00452434720366054;0.00452192155980347;0.00451949591594640;0.00451707027208933;0.00451464462823226;0.00451221898437519;0.00450979334051812;0.00450736769666105;0.00450494205280398;0.00450251640894691;0.00450009076508984;0.00449766512123277;0.00449523947737570;0.00449281383351863;0.00449038818966156;0.00448796254580449;0.00448553690194742;0.00447987180052621;0.00447420669910501;0.00446854159768380;0.00446287649626259;0.00445721139484139;0.00445154629342018;0.00444588119199898;0.00444021609057777;0.00443455098915657;0.00442888588773536;0.00442322078631416;0.00441755568489295;0.00441189058347175;0.00440622548205054;0.00440056038062933;0.00439489527920813;0.00438923017778692;0.00438356507636572;0.00437789997494451;0.00437223487352331;0.00437084854617334;0.00436946221882337;0.00436807589147341;0.00436668956412344;0.00436530323677347;0.00436391690942350;0.00436253058207354;0.00436114425472357;0.00435975792737360;0.00435837160002364;0.00435698527267367;0.00435559894532370;0.00435421261797374;0.00435282629062377;0.00435143996327380;0.00435005363592383;0.00434866730857387;0.00434728098122390;0.00434589465387393;0.00434450832652397;0.00434151922453469;0.00433853012254541;0.00433554102055613;0.00433255191856685;0.00432956281657757;0.00432657371458829;0.00432358461259901;0.00432059551060973;0.00431760640862045;0.00431461730663117;0.00431162820464189;0.00430863910265261;0.00430565000066334;0.00430266089867406;0.00429967179668478;0.00429668269469550;0.00429369359270622;0.00429070449071694;0.00428771538872766;0.00428472628673838;0.00428154907549385;0.00427837186424932;0.00427519465300479;0.00427201744176025;0.00426884023051572;0.00426566301927119;0.00426248580802666;0.00425930859678213;0.00425613138553760;0.00425295417429306;0.00424977696304853;0.00424659975180400;0.00424342254055947;0.00424024532931494;0.00423706811807041;0.00423389090682587;0.00423071369558134;0.00422753648433681;0.00422435927309228;0.00422118206184775;0.00421918461575732;0.00421718716966689;0.00421518972357647;0.00421319227748604;0.00421119483139561;0.00420919738530518;0.00420719993921476;0.00420520249312433;0.00420320504703390;0.00420120760094347;0.00419921015485305;0.00419721270876262;0.00419521526267219;0.00419321781658177;0.00419122037049134;0.00418922292440091;0.00418722547831048;0.00418522803222006;0.00418323058612963;0.00418123314003920;0.00417880184584732;0.00417637055165543;0.00417393925746355;0.00417150796327166;0.00416907666907978;0.00416664537488789;0.00416421408069601;0.00416178278650412;0.00415935149231224;0.00415692019812035;0.00415448890392847;0.00415205760973658;0.00414962631554470;0.00414719502135281;0.00414476372716093;0.00414233243296904;0.00413990113877716;0.00413746984458527;0.00413503855039339;0.00413260725620150;0.00412933226009185;0.00412605726398219;0.00412278226787254;0.00411950727176288;0.00411623227565323;0.00411295727954357;0.00410968228343392;0.00410640728732426;0.00410313229121461;0.00409985729510495;0.00409658229899530;0.00409330730288564;0.00409003230677599;0.00408675731066633;0.00408348231455668;0.00408020731844702;0.00407693232233737;0.00407365732622771;0.00407038233011806;0.00406710733400840;0.00406389500555276;0.00406068267709712;0.00405747034864148;0.00405425802018584;0.00405104569173019;0.00404783336327455;0.00404462103481891;0.00404140870636326;0.00403819637790762;0.00403498404945198;0.00403177172099634;0.00402855939254070;0.00402534706408505;0.00402213473562941;0.00401892240717377;0.00401571007871813;0.00401249775026248;0.00400928542180684;0.00400607309335120;0.00400286076489556;0.00400059860901663;0.00399833645313770;0.00399607429725877;0.00399381214137984;0.00399154998550091;0.00398928782962199;0.00398702567374306;0.00398476351786413;0.00398250136198520;0.00398023920610627;0.00397797705022734;0.00397571489434842;0.00397345273846949;0.00397119058259056;0.00396892842671163;0.00396666627083270;0.00396440411495377;0.00396214195907485;0.00395987980319592;0.00395761764731699;0.00395491621422676;0.00395221478113653;0.00394951334804630;0.00394681191495608;0.00394411048186585;0.00394140904877562;0.00393870761568539;0.00393600618259516;0.00393330474950494;0.00393060331641471;0.00392790188332448;0.00392520045023425;0.00392249901714402;0.00391979758405380;0.00391709615096357;0.00391439471787334;0.00391169328478311;0.00390899185169288;0.00390629041860266;0.00390358898551243;0.00390013197215082;0.00389667495878921;0.00389321794542760;0.00388976093206599;0.00388630391870438;0.00388284690534277;0.00387938989198116;0.00387593287861955;0.00387247586525795;0.00386901885189634;0.00386556183853473;0.00386210482517312;0.00385864781181151;0.00385519079844990;0.00385173378508829;0.00384827677172668;0.00384481975836507;0.00384136274500346;0.00383790573164185;0.00383444871828025;0.00383134873526853;0.00382824875225680;0.00382514876924508;0.00382204878623336;0.00381894880322164;0.00381584882020992;0.00381274883719820;0.00380964885418648;0.00380654887117476;0.00380344888816304;0.00380034890515132;0.00379724892213960;0.00379414893912788;0.00379104895611616;0.00378794897310444;0.00378484899009272;0.00378174900708100;0.00377864902406928;0.00377554904105756;0.00377244905804584;0.00376922300148271;0.00376599694491958;0.00376277088835646;0.00375954483179333;0.00375631877523020;0.00375309271866707;0.00374986666210394;0.00374664060554081;0.00374341454897768;0.00374018849241456;0.00373696243585143;0.00373373637928830;0.00373051032272517;0.00372728426616204;0.00372405820959891;0.00372083215303579;0.00371760609647266;0.00371438003990953;0.00371115398334640;0.00370792792678327;0.00370488634674129;0.00370184476669931;0.00369880318665733;0.00369576160661535;0.00369272002657336;0.00368967844653138;0.00368663686648940;0.00368359528644742;0.00368055370640544;0.00367751212636346;0.00367447054632148;0.00367142896627950;0.00366838738623751;0.00366534580619553;0.00366230422615355;0.00365926264611157;0.00365622106606959;0.00365317948602761;0.00365013790598563;0.00364709632594364;0.00364417406341057;0.00364125180087750;0.00363832953834443;0.00363540727581136;0.00363248501327829;0.00362956275074522;0.00362664048821215;0.00362371822567908;0.00362079596314601;0.00361787370061293;0.00361495143807986;0.00361202917554679;0.00360910691301372;0.00360618465048065;0.00360326238794758;0.00360034012541451;0.00359741786288144;0.00359449560034837;0.00359157333781529;0.00358865107528222;0.00358547349812089;0.00358229592095955;0.00357911834379822;0.00357594076663688;0.00357276318947555;0.00356958561231422;0.00356640803515288;0.00356323045799155;0.00356005288083021;0.00355687530366888;0.00355369772650754;0.00355052014934621;0.00354734257218487;0.00354416499502354;0.00354098741786220;0.00353780984070087;0.00353463226353953;0.00353145468637820;0.00352827710921686;0.00352509953205553;0.00352260104677178;0.00352010256148802;0.00351760407620427;0.00351510559092052;0.00351260710563677;0.00351010862035302;0.00350761013506926;0.00350511164978551;0.00350261316450176;0.00350011467921801;0.00349761619393426;0.00349511770865050;0.00349261922336675;0.00349012073808300;0.00348762225279925;0.00348512376751550;0.00348262528223174;0.00348012679694799;0.00347762831166424;0.00347512982638049;0.00347210288215616;0.00346907593793183;0.00346604899370749;0.00346302204948316;0.00345999510525883;0.00345696816103450;0.00345394121681017;0.00345091427258583;0.00344788732836150;0.00344486038413717;0.00344183343991284;0.00343880649568851;0.00343577955146418;0.00343275260723984;0.00342972566301551;0.00342669871879118;0.00342367177456685;0.00342064483034252;0.00341761788611818;0.00341459094189385;0.00341217347526988;0.00340975600864590;0.00340733854202193;0.00340492107539795;0.00340250360877398;0.00340008614215000;0.00339766867552603;0.00339525120890205;0.00339283374227808;0.00339041627565410;0.00338799880903012;0.00338558134240615;0.00338316387578217;0.00338074640915820;0.00337832894253422;0.00337591147591025;0.00337349400928627;0.00337107654266230;0.00336865907603832;0.00336624160941435;0.00336422793563264;0.00336221426185093;0.00336020058806922;0.00335818691428751;0.00335617324050581;0.00335415956672410;0.00335214589294239;0.00335013221916068;0.00334811854537897;0.00334610487159726;0.00334409119781556;0.00334207752403385;0.00334006385025214;0.00333805017647043;0.00333603650268872;0.00333402282890702;0.00333200915512531;0.00332999548134360;0.00332798180756189;0.00332596813378018;0.00332419830284825;0.00332242847191632;0.00332065864098439;0.00331888881005246;0.00331711897912053;0.00331534914818860;0.00331357931725667;0.00331180948632474;0.00331003965539281;0.00330826982446088;0.00330649999352895;0.00330473016259701;0.00330296033166508;0.00330119050073315;0.00329942066980122;0.00329765083886929;0.00329588100793736;0.00329411117700543;0.00329234134607350;0.00329057151514157;0.00328821001618350;0.00328584851722544;0.00328348701826737;0.00328112551930931;0.00327876402035124;0.00327640252139317;0.00327404102243511;0.00327167952347704;0.00326931802451898;0.00326695652556091;0.00326459502660285;0.00326223352764478;0.00325987202868672;0.00325751052972865;0.00325514903077058;0.00325278753181252;0.00325042603285445;0.00324806453389639;0.00324570303493832;0.00324334153598026;0.00324068244765090;0.00323802335932155;0.00323536427099220;0.00323270518266285;0.00323004609433349;0.00322738700600414;0.00322472791767479;0.00322206882934544;0.00321940974101608;0.00321675065268673;0.00321409156435738;0.00321143247602803;0.00320877338769867;0.00320611429936932;0.00320345521103997;0.00320079612271062;0.00319813703438127;0.00319547794605191;0.00319281885772256;0.00319015976939321;0.00318714786981584;0.00318413597023847;0.00318112407066110;0.00317811217108373;0.00317510027150636;0.00317208837192899;0.00316907647235162;0.00316606457277425;0.00316305267319688;0.00316004077361951;0.00315702887404214;0.00315401697446477;0.00315100507488740;0.00314799317531003;0.00314498127573266;0.00314196937615529;0.00313895747657792;0.00313594557700055;0.00313293367742318;0.00312992177784582;0.00312800203544026;0.00312608229303471;0.00312416255062915;0.00312224280822360;0.00312032306581805;0.00311840332341249;0.00311648358100694;0.00311456383860139;0.00311264409619583;0.00311072435379028;0.00310880461138472;0.00310688486897917;0.00310496512657362;0.00310304538416806;0.00310112564176251;0.00309920589935696;0.00309728615695140;0.00309536641454585;0.00309344667214029;0.00309152692973474;0.00308868754652530;0.00308584816331585;0.00308300878010641;0.00308016939689696;0.00307733001368752;0.00307449063047807;0.00307165124726863;0.00306881186405919;0.00306597248084974;0.00306313309764030;0.00306029371443085;0.00305745433122141;0.00305461494801196;0.00305177556480252;0.00304893618159307;0.00304609679838363;0.00304325741517419;0.00304041803196474;0.00303757864875530;0.00303473926554585;0.00303283413377212;0.00303092900199839;0.00302902387022466;0.00302711873845093;0.00302521360667720;0.00302330847490347;0.00302140334312974;0.00301949821135601;0.00301759307958228;0.00301568794780855;0.00301378281603483;0.00301187768426110;0.00300997255248737;0.00300806742071364;0.00300616228893991;0.00300425715716618;0.00300235202539245;0.00300044689361872;0.00299854176184499;0.00299663663007126;0.00299404307950391;0.00299144952893657;0.00298885597836923;0.00298626242780188;0.00298366887723454;0.00298107532666720;0.00297848177609985;0.00297588822553251;0.00297329467496517;0.00297070112439782;0.00296810757383048;0.00296551402326314;0.00296292047269579;0.00296032692212845;0.00295773337156111;0.00295513982099376;0.00295254627042642;0.00294995271985908;0.00294735916929174;0.00294476561872439;0.00294268626110104;0.00294060690347770;0.00293852754585435;0.00293644818823100;0.00293436883060766;0.00293228947298431;0.00293021011536096;0.00292813075773761;0.00292605140011427;0.00292397204249092;0.00292189268486757;0.00291981332724423;0.00291773396962088;0.00291565461199753;0.00291357525437418;0.00291149589675084;0.00290941653912749;0.00290733718150414;0.00290525782388080;0.00290317846625745;0.00290149294228651;0.00289980741831558;0.00289812189434464;0.00289643637037371;0.00289475084640277;0.00289306532243184;0.00289137979846090;0.00288969427448997;0.00288800875051903;0.00288632322654810;0.00288463770257716;0.00288295217860623;0.00288126665463529;0.00287958113066436;0.00287789560669342;0.00287621008272249;0.00287452455875156;0.00287283903478062;0.00287115351080969;0.00286946798683875;0.00286735025907001;0.00286523253130128;0.00286311480353254;0.00286099707576381;0.00285887934799507;0.00285676162022634;0.00285464389245760;0.00285252616468887;0.00285040843692013;0.00284829070915139;0.00284617298138266;0.00284405525361392;0.00284193752584519;0.00283981979807645;0.00283770207030772;0.00283558434253898;0.00283346661477024;0.00283134888700151;0.00282923115923277;0.00282711343146404;0.00282548733493518;0.00282386123840632;0.00282223514187746;0.00282060904534860;0.00281898294881974;0.00281735685229088;0.00281573075576202;0.00281410465923317;0.00281247856270431;0.00281085246617545;0.00280922636964659;0.00280760027311773;0.00280597417658887;0.00280434808006001;0.00280272198353115;0.00280109588700229;0.00279946979047343;0.00279784369394458;0.00279621759741572;0.00279459150088686;0.00279284602362081;0.00279110054635476;0.00278935506908871;0.00278760959182267;0.00278586411455662;0.00278411863729057;0.00278237316002452;0.00278062768275848;0.00277888220549243;0.00277713672822638;0.00277539125096034;0.00277364577369429;0.00277190029642824;0.00277015481916219;0.00276840934189615;0.00276666386463010;0.00276491838736405;0.00276317291009800;0.00276142743283196;0.00275968195556591;0.00275900315363722;0.00275832435170854;0.00275764554977985;0.00275696674785117;0.00275628794592249;0.00275560914399380;0.00275493034206512;0.00275425154013643;0.00275357273820775;0.00275289393627906;0.00275221513435038;0.00275153633242169;0.00275085753049301;0.00275017872856433;0.00274949992663564;0.00274882112470696;0.00274814232277827;0.00274746352084959;0.00274678471892090;0.00274610591699222;0.00274479466509199;0.00274348341319177;0.00274217216129155;0.00274086090939132;0.00273954965749110;0.00273823840559087;0.00273692715369065;0.00273561590179042;0.00273430464989020;0.00273299339798997;0.00273168214608975;0.00273037089418953;0.00272905964228930;0.00272774839038908;0.00272643713848885;0.00272512588658863;0.00272381463468840;0.00272250338278818;0.00272119213088795;0.00271988087898773;0.00271844262437139;0.00271700436975505;0.00271556611513871;0.00271412786052237;0.00271268960590604;0.00271125135128970;0.00270981309667336;0.00270837484205702;0.00270693658744068;0.00270549833282434;0.00270406007820800;0.00270262182359166;0.00270118356897533;0.00269974531435899;0.00269830705974265;0.00269686880512631;0.00269543055050997;0.00269399229589363;0.00269255404127729;0.00269111578666095;0.00268976555290640;0.00268841531915185;0.00268706508539730;0.00268571485164274;0.00268436461788819;0.00268301438413364;0.00268166415037909;0.00268031391662453;0.00267896368286998;0.00267761344911543;0.00267626321536088;0.00267491298160632;0.00267356274785177;0.00267221251409722;0.00267086228034267;0.00266951204658811;0.00266816181283356;0.00266681157907901;0.00266546134532446;0.00266411111156990;0.00266277008510354;0.00266142905863717;0.00266008803217081;0.00265874700570444;0.00265740597923807;0.00265606495277171;0.00265472392630534;0.00265338289983897;0.00265204187337261;0.00265070084690624;0.00264935982043987;0.00264801879397351;0.00264667776750714;0.00264533674104078;0.00264399571457441;0.00264265468810804;0.00264131366164168;0.00263997263517531;0.00263863160870894;0.00263729058224258;0.00263630855504074;0.00263532652783891;0.00263434450063707;0.00263336247343523;0.00263238044623340;0.00263139841903156;0.00263041639182973;0.00262943436462789;0.00262845233742605;0.00262747031022422;0.00262648828302238;0.00262550625582054;0.00262452422861871;0.00262354220141687;0.00262256017421504;0.00262157814701320;0.00262059611981136;0.00261961409260953;0.00261863206540769;0.00261765003820586;0.00261651808055691;0.00261538612290797;0.00261425416525902;0.00261312220761008;0.00261199024996113;0.00261085829231219;0.00260972633466324;0.00260859437701430;0.00260746241936535;0.00260633046171641;0.00260519850406746;0.00260406654641851;0.00260293458876957;0.00260180263112062;0.00260067067347168;0.00259953871582273;0.00259840675817379;0.00259727480052484;0.00259614284287590;0.00259501088522695;0.00259418770048708;0.00259336451574721;0.00259254133100734;0.00259171814626747;0.00259089496152760;0.00259007177678773;0.00258924859204786;0.00258842540730799;0.00258760222256811;0.00258677903782824;0.00258595585308837;0.00258513266834850;0.00258430948360863;0.00258348629886876;0.00258266311412889;0.00258183992938902;0.00258101674464915;0.00258019355990928;0.00257937037516940;0.00257854719042953;0.00257771300524756;0.00257687882006560;0.00257604463488363;0.00257521044970166;0.00257437626451969;0.00257354207933772;0.00257270789415575;0.00257187370897378;0.00257103952379181;0.00257020533860984;0.00256937115342788;0.00256853696824591;0.00256770278306394;0.00256686859788197;0.00256603441270000;0.00256520022751803;0.00256436604233606;0.00256353185715409;0.00256269767197212;0.00256186348679016;0.00256112124756298;0.00256037900833580;0.00255963676910862;0.00255889452988144;0.00255815229065426;0.00255741005142709;0.00255666781219991;0.00255592557297273;0.00255518333374555;0.00255444109451837;0.00255369885529120;0.00255295661606402;0.00255221437683684;0.00255147213760966;0.00255072989838248;0.00254998765915531;0.00254924541992813;0.00254850318070095;0.00254776094147377;0.00254701870224659;0.00254598236338675;0.00254494602452691;0.00254390968566707;0.00254287334680723;0.00254183700794739;0.00254080066908754;0.00253976433022770;0.00253872799136786;0.00253769165250802;0.00253665531364818;0.00253561897478834;0.00253458263592850;0.00253354629706865;0.00253250995820881;0.00253147361934897;0.00253043728048913;0.00252940094162929;0.00252836460276945;0.00252732826390960;0.00252629192504976;0.00252565717432637;0.00252502242360297;0.00252438767287958;0.00252375292215618;0.00252311817143278;0.00252248342070939;0.00252184866998599;0.00252121391926260;0.00252057916853920;0.00251994441781581;0.00251930966709241;0.00251867491636901;0.00251804016564562;0.00251740541492222;0.00251677066419883;0.00251613591347543;0.00251550116275204;0.00251486641202864;0.00251423166130524;0.00251359691058185;0.00251272400588697;0.00251185110119208;0.00251097819649720;0.00251010529180232;0.00250923238710743;0.00250835948241255;0.00250748657771767;0.00250661367302279;0.00250574076832790;0.00250486786363302;0.00250399495893814;0.00250312205424326;0.00250224914954837;0.00250137624485349;0.00250050334015861;0.00249963043546372;0.00249875753076884;0.00249788462607396;0.00249701172137908;0.00249613881668419;0.00249518807209890;0.00249423732751361;0.00249328658292832;0.00249233583834303;0.00249138509375774;0.00249043434917245;0.00248948360458716;0.00248853286000187;0.00248758211541658;0.00248663137083129;0.00248568062624600;0.00248472988166071;0.00248377913707542;0.00248282839249013;0.00248187764790484;0.00248092690331955;0.00247997615873426;0.00247902541414897;0.00247807466956368;0.00247712392497839;0.00247630611834639;0.00247548831171439;0.00247467050508239;0.00247385269845039;0.00247303489181839;0.00247221708518640;0.00247139927855440;0.00247058147192240;0.00246976366529040;0.00246894585865840;0.00246812805202641;0.00246731024539441;0.00246649243876241;0.00246567463213041;0.00246485682549841;0.00246403901886642;0.00246322121223442;0.00246240340560242;0.00246158559897042;0.00246076779233842;0.00245987883090254;0.00245898986946666;0.00245810090803078;0.00245721194659490;0.00245632298515902;0.00245543402372314;0.00245454506228726;0.00245365610085138;0.00245276713941550;0.00245187817797962;0.00245098921654374;0.00245010025510786;0.00244921129367198;0.00244832233223610;0.00244743337080022;0.00244654440936434;0.00244565544792846;0.00244476648649258;0.00244387752505670;0.00244298856362082;0.00244205181117103;0.00244111505872124;0.00244017830627145;0.00243924155382166;0.00243830480137187;0.00243736804892208;0.00243643129647229;0.00243549454402250;0.00243455779157271;0.00243362103912292;0.00243268428667313;0.00243174753422334;0.00243081078177355;0.00242987402932376;0.00242893727687397;0.00242800052442418;0.00242706377197439;0.00242612701952460;0.00242519026707481;0.00242425351462502;0.00242325033820151;0.00242224716177801;0.00242124398535450;0.00242024080893099;0.00241923763250748;0.00241823445608397;0.00241723127966046;0.00241622810323696;0.00241522492681345;0.00241422175038994;0.00241321857396643;0.00241221539754292;0.00241121222111941;0.00241020904469591;0.00240920586827240;0.00240820269184889;0.00240719951542538;0.00240619633900187;0.00240519316257836;0.00240418998615486;0.00240327662590767;0.00240236326566048;0.00240144990541329;0.00240053654516610;0.00239962318491892;0.00239870982467173;0.00239779646442454;0.00239688310417735;0.00239596974393016;0.00239505638368298;0.00239414302343579;0.00239322966318860;0.00239231630294141;0.00239140294269422;0.00239048958244704;0.00238957622219985;0.00238866286195266;0.00238774950170547;0.00238683614145828;0.00238592278121110;0.00238503875714485;0.00238415473307860;0.00238327070901235;0.00238238668494610;0.00238150266087985;0.00238061863681360;0.00237973461274735;0.00237885058868110;0.00237796656461485;0.00237708254054860;0.00237619851648235;0.00237531449241610;0.00237443046834985;0.00237354644428360;0.00237266242021735;0.00237177839615110;0.00237089437208485;0.00237001034801860;0.00236912632395235;0.00236824229988610;0.00236742086122257;0.00236659942255905;0.00236577798389552;0.00236495654523200;0.00236413510656848;0.00236331366790495;0.00236249222924143;0.00236167079057790;0.00236084935191438;0.00236002791325086;0.00235920647458733;0.00235838503592381;0.00235756359726028;0.00235674215859676;0.00235592071993323;0.00235509928126971;0.00235427784260619;0.00235345640394266;0.00235263496527914;0.00235181352661561;0.00235104510613265;0.00235027668564968;0.00234950826516671;0.00234873984468375;0.00234797142420078;0.00234720300371781;0.00234643458323485;0.00234566616275188;0.00234489774226891;0.00234412932178595;0.00234336090130298;0.00234259248082001;0.00234182406033704;0.00234105563985408;0.00234028721937111;0.00233951879888814;0.00233875037840518;0.00233798195792221;0.00233721353743924;0.00233644511695628;0.00233569275522170;0.00233494039348713;0.00233418803175256;0.00233343567001798;0.00233268330828341;0.00233193094654883;0.00233117858481426;0.00233042622307969;0.00232967386134511;0.00232892149961054;0.00232816913787596;0.00232741677614139;0.00232666441440681;0.00232591205267224;0.00232515969093767;0.00232440732920309;0.00232365496746852;0.00232290260573394;0.00232215024399937;0.00232139788226480;0.00232058871082785;0.00231977953939090;0.00231897036795394;0.00231816119651699;0.00231735202508004;0.00231654285364309;0.00231573368220614;0.00231492451076919;0.00231411533933224;0.00231330616789529;0.00231249699645834;0.00231168782502139;0.00231087865358444;0.00231006948214749;0.00230926031071054;0.00230845113927359;0.00230764196783664;0.00230683279639969;0.00230602362496274;0.00230521445352578;0.00230441683995159;0.00230361922637740;0.00230282161280321;0.00230202399922902;0.00230122638565482;0.00230042877208063;0.00229963115850644;0.00229883354493225;0.00229803593135806;0.00229723831778386;0.00229644070420967;0.00229564309063548;0.00229484547706129;0.00229404786348709;0.00229325024991290;0.00229245263633871;0.00229165502276452;0.00229085740919033;0.00229005979561613;0.00228926218204194;0.00228844447991997;0.00228762677779801;0.00228680907567604;0.00228599137355407;0.00228517367143210;0.00228435596931013;0.00228353826718817;0.00228272056506620;0.00228190286294423;0.00228108516082226;0.00228026745870030;0.00227944975657833;0.00227863205445636;0.00227781435233439;0.00227699665021242;0.00227617894809046;0.00227536124596849;0.00227454354384652;0.00227372584172455;0.00227290813960259;0.00227201966140139;0.00227113118320020;0.00227024270499900;0.00226935422679781;0.00226846574859662;0.00226757727039542;0.00226668879219423;0.00226580031399303;0.00226491183579184;0.00226402335759065;0.00226313487938945;0.00226224640118826;0.00226135792298706;0.00226046944478587;0.00225958096658468;0.00225869248838348;0.00225780401018229;0.00225691553198109;0.00225602705377990;0.00225513857557871;0.00225421709645477;0.00225329561733084;0.00225237413820690;0.00225145265908297;0.00225053117995903;0.00224960970083509;0.00224868822171116;0.00224776674258722;0.00224684526346329;0.00224592378433935;0.00224500230521542;0.00224408082609148;0.00224315934696755;0.00224223786784361;0.00224131638871968;0.00224039490959574;0.00223947343047181;0.00223855195134787;0.00223763047222394;0.00223670899310000;0.00223573640601696;0.00223476381893392;0.00223379123185088;0.00223281864476784;0.00223184605768480;0.00223087347060176;0.00222990088351872;0.00222892829643568;0.00222795570935264;0.00222698312226960;0.00222601053518656;0.00222503794810351;0.00222406536102047;0.00222309277393743;0.00222212018685439;0.00222114759977135;0.00222017501268831;0.00221920242560527;0.00221822983852223;0.00221725725143919;0.00221637544561110;0.00221549363978302;0.00221461183395493;0.00221373002812685;0.00221284822229876;0.00221196641647068;0.00221108461064259;0.00221020280481451;0.00220932099898642;0.00220843919315834;0.00220755738733025;0.00220667558150217;0.00220579377567408;0.00220491196984600;0.00220403016401791;0.00220314835818983;0.00220226655236174;0.00220138474653365;0.00220050294070557;0.00219962113487748;0.00219873743733929;0.00219785373980110;0.00219697004226291;0.00219608634472472;0.00219520264718653;0.00219431894964833;0.00219343525211014;0.00219255155457195;0.00219166785703376;0.00219078415949557;0.00218990046195738;0.00218901676441919;0.00218813306688099;0.00218724936934280;0.00218636567180461;0.00218548197426642;0.00218459827672823;0.00218371457919004;0.00218283088165184;0.00218194718411365;0.00218104185957639;0.00218013653503913;0.00217923121050186;0.00217832588596460;0.00217742056142734;0.00217651523689007;0.00217560991235281;0.00217470458781555;0.00217379926327828;0.00217289393874102;0.00217198861420375;0.00217108328966649;0.00217017796512923;0.00216927264059196;0.00216836731605470;0.00216746199151744;0.00216655666698017;0.00216565134244291;0.00216474601790565;0.00216384069336838;0.00216290263159114;0.00216196456981390;0.00216102650803667;0.00216008844625943;0.00215915038448219;0.00215821232270495;0.00215727426092771;0.00215633619915047;0.00215539813737323;0.00215446007559599;0.00215352201381876;0.00215258395204152;0.00215164589026428;0.00215070782848704;0.00214976976670980;0.00214883170493256;0.00214789364315532;0.00214695558137808;0.00214601751960085;0.00214507945782361;0.00214429643716793;0.00214351341651224;0.00214273039585656;0.00214194737520088;0.00214116435454520;0.00214038133388952;0.00213959831323384;0.00213881529257816;0.00213803227192248;0.00213724925126680;0.00213646623061112;0.00213568320995543;0.00213490018929975;0.00213411716864407;0.00213333414798839;0.00213255112733271;0.00213176810667703;0.00213098508602135;0.00213020206536567;0.00212941904470999;0.00212862504682296;0.00212783104893593;0.00212703705104890;0.00212624305316187;0.00212544905527484;0.00212465505738781;0.00212386105950078;0.00212306706161375;0.00212227306372672;0.00212147906583969;0.00212068506795266;0.00211989107006563;0.00211909707217860;0.00211830307429157;0.00211750907640454;0.00211671507851751;0.00211592108063048;0.00211512708274345;0.00211433308485642;0.00211353908696939;0.00211278322129838;0.00211202735562736;0.00211127148995635;0.00211051562428534;0.00210975975861433;0.00210900389294332;0.00210824802727230;0.00210749216160129;0.00210673629593028;0.00210598043025927;0.00210522456458826;0.00210446869891724;0.00210371283324623;0.00210295696757522;0.00210220110190421;0.00210144523623320;0.00210068937056218;0.00209993350489117;0.00209917763922016;0.00209842177354915;];

% Put all the filenames in a cell array by channel and filename
filenames = ['*Track-01.wav'; '*Track-02.wav'; '*Track-03.wav'];
for channel=1:3
    wave_list{channel} = dir(filenames(channel,:));
end
% Prename output files
outputfilenames=['X_vel_acc.xlsx'; 'Y_vel_acc.xlsx'; 'Z_vel_acc.xlsx'];

for i=1:length(wave_list{1}) % Loop over each recording
    [datach1,fs]=wavread(wave_list{1,1}(i).name); % Read in channel 1 and sampling frequency
    datach2=wavread(wave_list{1,2}(i).name);
    datach3=wavread(wave_list{1,3}(i).name);
    
    % Calibrate voltage for sound card attenuation (* because used input/output for cal)
    datach1cal=datach1.*cals(1);
    datach2cal=datach2.*cals(2);
    datach3cal=datach3.*cals(3);
    
    %% Move into the frequency domain
    %take FFT of input signal to get amplitudes vs. frequencies
    nfft = 1024; % chose fft length
    olap=0; % set overlap as a fraction 
    
    % Channel 1 FFT
    data2ch1 = buffer(datach1cal,nfft,ceil(nfft*olap),'nodelay'); % (allows overlap)
    [m,n] = size(data2ch1);
    data2ch1 = data2ch1.*repmat(hamming(nfft),1,n)/0.54; % hamming filtering optional 
    fft_data_ch1 = abs(fft(data2ch1))./nfft;
    fft_amp_ch1=fft_data_ch1(1:nfft/2+1,:).^2;
    hammcorrect = 1.36;                 %correction for the noise power bandwidwith of Hamming window
    fft_amp_ch1=2*fft_amp_ch1/hammcorrect;
    f = (fs/2*linspace(0,1,nfft/2+1))';
    wintime = nfft/fs;      %time in seconds of window
    
    fft_amp_ch1 = fft_amp_ch1*wintime;
    
    allfreqs = (0:1:3000)';
    %Match the resolution of the Calibration data to that of the selected file
    interpcalib = interp1(allfreqs,sens,f);
    
    % Channel 2 FFT
    data2ch2 = buffer(datach2cal,nfft,ceil(nfft*olap),'nodelay'); % (allows overlap)
    [k,l] = size(data2ch2);
    data2ch2 = data2ch2.*repmat(hamming(nfft),1,l)/0.54; % hamming filtering optional 
    fft_data_ch2 = abs(fft(data2ch2))./nfft;
    fft_amp_ch2=fft_data_ch2(1:nfft/2+1,:).^2;
    hammcorrect = 1.36;                 %correction for the noise power bandwidwith of Hamming window
    fft_amp_ch2=2*fft_amp_ch2/hammcorrect;
    f = (fs/2*linspace(0,1,nfft/2+1))';
    wintime = nfft/fs;      %time in seconds of window
    fft_amp_ch2 = fft_amp_ch2*wintime;
    
    % Channel 3 FFT
    data2ch3 = buffer(datach3cal,nfft,ceil(nfft*olap),'nodelay'); % (allows overlap)
    [g,w] = size(data2ch3);
    data2ch3 = data2ch3.*repmat(hamming(nfft),1,w)/0.54; % hamming filtering optional 
    fft_data_ch3 = abs(fft(data2ch3))./nfft;
    fft_amp_ch3=fft_data_ch3(1:nfft/2+1,:).^2;
    hammcorrect = 1.36;                 %correction for the noise power bandwidwith of Hamming window
    fft_amp_ch3=2*fft_amp_ch3/hammcorrect;
    f = (fs/2*linspace(0,1,nfft/2+1))';
    wintime = nfft/fs;      %time in seconds of window
    fft_amp_ch3 = fft_amp_ch3*wintime;
    
    %% Calculate acceleration
    % Velocity = Acceleration / Angular Frequency
    % m/s      = m/s/s        / 2.pi.f
    AF = 2*pi*f; % angular frequency
    interpcalibmatrix1 = repmat(interpcalib,1,n); % Calibration constants
    AFmatrix1 = repmat(AF,1,n); % Container for spectrogram data (matrix containing repeated angular frequencies)

    acc1 = ((fft_amp_ch1./interpcalibmatrix1).*AFmatrix1)./10^-6;
    dBacc1 = 10*log10(acc1); % spectrogram cData
    
    interpcalibmatrix2 = repmat(interpcalib,1,l);
    AFmatrix2 = repmat(AF,1,l);
    acc2 = ((fft_amp_ch2./interpcalibmatrix2).*AFmatrix2)./10^-6;
    dBacc2 = 10*log10(acc2);
    interpcalibmatrix3 = repmat(interpcalib,1,w);
    AFmatrix3 = repmat(AF,1,w);
    acc3 = ((fft_amp_ch3./interpcalibmatrix3).*AFmatrix3)./10^-6;
    dBacc3 = 10*log10(acc3);
    % Calculate the magnitude if tracks from different channels were the
    % same length
    if n == l && n == w
        dBacc_mag = 10*log10(sqrt(acc1.^2 + acc2.^2 + acc3.^2));
    end
    
    % Store mean, 5%, 50% and 95% exceedance levels in dB re 1 (um/s/s)^2/Hz
    % for each channel and all three channels combined
    % Mean
    acc1_mean(:,i) = 10*log10(mean(acc1,2));
    acc2_mean(:,i) = 10*log10(mean(acc2,2));
    acc3_mean(:,i) = 10*log10(mean(acc3,2));
    acc_mean_mag(:,i) = 10*log10(sqrt(mean(acc1,2).^2+mean(acc2,2).^2+mean(acc3,2).^2));
    % Percentiles
    p = [5 50 95];
    pct1 = prctile(acc1,p,2);
    pct2 = prctile(acc2,p,2);
    pct3 = prctile(acc3,p,2);
    acc1_pct(:,i,1) = 10*log10(pct1(:,1));
    acc1_pct(:,i,2) = 10*log10(pct1(:,2));
    acc1_pct(:,i,3) = 10*log10(pct1(:,3));
    acc2_pct(:,i,1) = 10*log10(pct2(:,1));
    acc2_pct(:,i,2) = 10*log10(pct2(:,2));
    acc2_pct(:,i,3) = 10*log10(pct2(:,3));
    acc3_pct(:,i,1) = 10*log10(pct3(:,1));
    acc3_pct(:,i,2) = 10*log10(pct3(:,2));
    acc3_pct(:,i,3) = 10*log10(pct3(:,3));
    acc_pct_mag(:,i,1) = 10*log10(sqrt(pct1(:,1).^2+pct2(:,1).^2+pct3(:,1).^2));
    acc_pct_mag(:,i,2) = 10*log10(sqrt(pct1(:,2).^2+pct2(:,2).^2+pct3(:,2).^2));
    acc_pct_mag(:,i,3) = 10*log10(sqrt(pct1(:,3).^2+pct2(:,3).^2+pct3(:,3).^2));
    
    name=wave_list{1,1}(i).name(1:end-4);
    
    %% SPECTROGRAMS
    % Spectrogram acceleration channel 1
    
    %x axis (in seconds)
    t1 = length(datach1)/fs;
    nt1 = linspace(0,t1,n)';
    
    fig1 = figure;
    surf(nt1,f,dBacc1,'edgecolor','none')
    xlabel('Time (s)')
    xlim([0 t1])
    ylabel(['Frequency (Hz)'])
    ylim([1 3001])
    caxis([0, 100])
    h = colorbar;
    title(h,'PSD (dB re 1 (\mum/s^2)^2 /Hz')
    view(0,90)
    saveas(fig1, ['A_ch1_spec' name '.tiff'])
    close(fig1)
    
    % Spectrogram acceleration channel 2
    t2 = length(datach2)/fs;
    nt2 = linspace(0,t2,l)';
    fig2 = figure;
    surf(nt2,f,dBacc2,'edgecolor','none')
    xlabel('Time (s)')
    xlim([0 t2])
    ylabel(['Frequency (Hz)'])
    ylim([1 3001])
    caxis([0, 100])
    h = colorbar;
    title(h,'PSD (dB re 1 (\mum/s^2)^2 /Hz')
    view(0,90)
    saveas(fig2, ['A_ch2_spec' name '.tiff']) 
    close(fig2)
    
    % Spectrogram acceleration channel 3
    t3 = length(datach3)/fs;
    nt3 = linspace(0,t3,w)';
    fig3 = figure;
    surf(nt3,f,dBacc3,'edgecolor','none')
    xlabel('Time (s)')
    xlim([0 t3])
    ylabel(['Frequency (Hz)'])
    ylim([1 3001])
    caxis([0, 100])
    h = colorbar;
    title(h,'PSD (dB re 1 (\mum/s^2)^2 /Hz')
    view(0,90)
    saveas(fig3, ['A_ch3_spec' name '.tiff'])
    close(fig3)
    
    % Spectrogram acceleration three channels combined
    if n == l && n == w
    fig4 = figure;
    name=wave_list{1,1}(i).name(1:end-4);
    surf(nt1,f,dBacc_mag,'edgecolor','none')
    xlabel('Time (s)')
    ylabel(['Frequency (Hz)'])
    xlim([0 t1])
    ylim([1 3001])
    caxis([0, 100])
    h = colorbar;
    title(h,'PSD (dB re 1 (\mum/s^2)^2 /Hz')
    view(0,90)
    saveas(fig4, ['A_mag_spec' name '.tiff'])
    close(fig4)
    end
    %%
    
    
    % Acceleration in dB re 1 (um/s/s)^2/Hz
    columnnames1={'Frequency (Hz)' wave_list{1,1}.name};
    xlswrite('X',columnnames1,'MeanA','A1');
    xlswrite('X',f,'MeanA','A2:A3002');
    xlswrite('X',acc1_mean,'MeanA','B2');
    xlswrite('X',columnnames1,'5%A','A1');
    xlswrite('X',f,'5%A','A2:A3002');
    xlswrite('X',acc1_pct(:,:,1),'5%A','B2');
    xlswrite('X',columnnames1,'50%A','A1');
    xlswrite('X',f,'50%A','A2:A3002');
    xlswrite('X',acc1_pct(:,:,2),'50%A','B2');
    xlswrite('X',columnnames1,'95%A','A1');
    xlswrite('X',f,'95%A','A2:A3002');
    xlswrite('X',acc1_pct(:,:,3),'95%A','B2');
    
    columnnames2={'Frequency (Hz)' wave_list{1,2}.name};
    xlswrite('Y',columnnames2,'MeanA','A1');
    xlswrite('Y',f,'MeanA','A2:A3002');
    xlswrite('Y',acc2_mean,'MeanA','B2');
    xlswrite('Y',columnnames2,'5%A','A1');
    xlswrite('Y',f,'5%A','A2:A3002');
    xlswrite('Y',acc2_pct(:,:,1),'5%A','B2');
    xlswrite('Y',columnnames2,'50%A','A1');
    xlswrite('Y',f,'50%A','A2:A3002');
    xlswrite('Y',acc2_pct(:,:,2),'50%A','B2');
    xlswrite('Y',columnnames2,'95%A','A1');
    xlswrite('Y',f,'95%A','A2:A3002');
    xlswrite('Y',acc2_pct(:,:,3),'95%A','B2');
    
    columnnames3={'Frequency (Hz)' wave_list{1,3}.name};
    xlswrite('Z',columnnames3,'MeanA','A1');
    xlswrite('Z',f,'MeanA','A2:A3002');
    xlswrite('Z',acc3_mean,'MeanA','B2');
    xlswrite('Z',columnnames3,'5%A','A1');
    xlswrite('Z',f,'5%A','A2:A3002');
    xlswrite('Z',acc3_pct(:,:,1),'5%A','B2');
    xlswrite('Z',columnnames3,'50%A','A1');
    xlswrite('Z',f,'50%A','A2:A3002');
    xlswrite('Z',acc3_pct(:,:,2),'50%A','B2');
    xlswrite('Z',columnnames3,'95%A','A1');
    xlswrite('Z',f,'95%A','A2:A3002');
    xlswrite('Z',acc3_pct(:,:,3),'95%A','B2');

    xlswrite('Amagnitude.xlsx',columnnames1,'MeanA','A1');
    xlswrite('Amagnitude.xlsx',f,'MeanA','A2:A3002');
    xlswrite('Amagnitude.xlsx',acc_mean_mag,'MeanA','B2');
    xlswrite('Amagnitude.xlsx',columnnames1,'5%A','A1');
    xlswrite('Amagnitude.xlsx',f,'5%A','A2:A3002');
    xlswrite('Amagnitude.xlsx',acc_pct_mag(:,:,1),'5%A','B2');
    xlswrite('Amagnitude.xlsx',columnnames1,'50%A','A1');
    xlswrite('Amagnitude.xlsx',f,'50%A','A2:A3002');
    xlswrite('Amagnitude.xlsx',acc_pct_mag(:,:,2),'50%A','B2');
    xlswrite('Amagnitude.xlsx',columnnames1,'95%A','A1');
    xlswrite('Amagnitude.xlsx',f,'95%A','A2:A3002');
    xlswrite('Amagnitude.xlsx',acc_pct_mag(:,:,3),'95%A','B2');
end
